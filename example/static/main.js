(()=>{var e,t,n="undefined"==typeof document?void 0:document,o=!!n&&"content"in n.createElement("template"),a=!!n&&n.createRange&&"createContextualFragment"in n.createRange();function r(e,t){var n,o,a=e.nodeName,r=t.nodeName;return a===r||((n=a.charCodeAt(0),o=r.charCodeAt(0),n<=90&&o>=97)?a===r.toUpperCase():o<=90&&n>=97&&r===a.toUpperCase())}function i(e,t,n){e[n]!==t[n]&&(e[n]=t[n],e[n]?e.setAttribute(n,""):e.removeAttribute(n))}var l={OPTION:function(e,t){var n=e.parentNode;if(n){var o=n.nodeName.toUpperCase();"OPTGROUP"===o&&(o=(n=n.parentNode)&&n.nodeName.toUpperCase()),"SELECT"!==o||n.hasAttribute("multiple")||(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),n.selectedIndex=-1)}i(e,t,"selected")},INPUT:function(e,t){i(e,t,"checked"),i(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var n=t.value;e.value!==n&&(e.value=n);var o=e.firstChild;if(o){var a=o.nodeValue;if(a==n||!n&&a==e.placeholder)return;o.nodeValue=n}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var n,o,a=-1,r=0,i=e.firstChild;i;)if("OPTGROUP"===(o=i.nodeName&&i.nodeName.toUpperCase()))i=(n=i).firstChild;else{if("OPTION"===o){if(i.hasAttribute("selected")){a=r;break}r++}(i=i.nextSibling)||!n||(i=n.nextSibling,n=null)}e.selectedIndex=a}}};function d(){}function s(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}var c=(t=function(e,t){var n,o,a,r,i=t.attributes;if(11!==t.nodeType&&11!==e.nodeType){for(var l=i.length-1;l>=0;l--)o=(n=i[l]).name,a=n.namespaceURI,r=n.value,a?(o=n.localName||o,e.getAttributeNS(a,o)!==r&&("xmlns"===n.prefix&&(o=n.name),e.setAttributeNS(a,o,r))):e.getAttribute(o)!==r&&e.setAttribute(o,r);for(var d=e.attributes,s=d.length-1;s>=0;s--)o=(n=d[s]).name,(a=n.namespaceURI)?(o=n.localName||o,t.hasAttributeNS(a,o)||e.removeAttributeNS(a,o)):t.hasAttribute(o)||e.removeAttribute(o)}},function(i,c,u){if(u||(u={}),"string"==typeof c){if("#document"===i.nodeName||"HTML"===i.nodeName||"BODY"===i.nodeName){var f,m,v,g,p,h,N,b,A=c;(c=n.createElement("html")).innerHTML=A}else f=(f=c).trim(),c=o?(m=f,(v=n.createElement("template")).innerHTML=m,v.content.childNodes[0]):a?(g=f,e||(e=n.createRange()).selectNode(n.body),e.createContextualFragment(g).childNodes[0]):(p=f,(h=n.createElement("body")).innerHTML=p,h.childNodes[0])}else 11===c.nodeType&&(c=c.firstElementChild);var S=u.getNodeKey||s,C=u.onBeforeNodeAdded||d,E=u.onNodeAdded||d,T=u.onBeforeElUpdated||d,y=u.onElUpdated||d,w=u.onBeforeNodeDiscarded||d,x=u.onNodeDiscarded||d,O=u.onBeforeElChildrenUpdated||d,k=u.skipFromChildren||d,U=u.addChild||function(e,t){return e.appendChild(t)},R=!0===u.childrenOnly,V=Object.create(null),I=[];function L(e){I.push(e)}function $(e,t,n){!1!==w(e)&&(t&&t.removeChild(e),x(e),function e(t,n){if(1===t.nodeType)for(var o=t.firstChild;o;){var a=void 0;n&&(a=S(o))?L(a):(x(o),o.firstChild&&e(o,n)),o=o.nextSibling}}(e,n))}function B(e){if(1===e.nodeType||11===e.nodeType)for(var t=e.firstChild;t;){var n=S(t);n&&(V[n]=t),B(t),t=t.nextSibling}}B(i);var M=i,H=M.nodeType,P=c.nodeType;if(!R){if(1===H)1===P?r(i,c)||(x(i),M=function(e,t){for(var n=e.firstChild;n;){var o=n.nextSibling;t.appendChild(n),n=o}return t}(i,(N=c.nodeName,(b=c.namespaceURI)&&"http://www.w3.org/1999/xhtml"!==b?n.createElementNS(b,N):n.createElement(N)))):M=c;else if(3===H||8===H){if(P===H)return M.nodeValue!==c.nodeValue&&(M.nodeValue=c.nodeValue),M;M=c}}if(M===c)x(i);else{if(c.isSameNode&&c.isSameNode(M))return;if(function e(o,a,i){var d=S(a);if(d&&delete V[d],!i){var s=T(o,a);if(!1===s||(s instanceof HTMLElement&&B(o=s),t(o,a),y(o),!1===O(o,a)))return}"TEXTAREA"!==o.nodeName?function(t,o){var a,i,d,s,c,u=k(t,o),f=o.firstChild,m=t.firstChild;e:for(;f;){for(s=f.nextSibling,a=S(f);!u&&m;){if(d=m.nextSibling,f.isSameNode&&f.isSameNode(m)){f=s,m=d;continue e}i=S(m);var v=m.nodeType,g=void 0;if(v===f.nodeType&&(1===v?(a?a!==i&&((c=V[a])?d===c?g=!1:(t.insertBefore(c,m),i?L(i):$(m,t,!0),i=S(m=c)):g=!1):i&&(g=!1),(g=!1!==g&&r(m,f))&&e(m,f)):(3===v||8==v)&&(g=!0,m.nodeValue!==f.nodeValue&&(m.nodeValue=f.nodeValue))),g){f=s,m=d;continue e}i?L(i):$(m,t,!0),m=d}if(a&&(c=V[a])&&r(c,f))u||U(t,c),e(c,f);else{var p=C(f);!1!==p&&(p&&(f=p),f.actualize&&(f=f.actualize(t.ownerDocument||n)),U(t,f),function t(n){E(n);for(var o=n.firstChild;o;){var a=o.nextSibling,i=S(o);if(i){var l=V[i];l&&r(o,l)?(o.parentNode.replaceChild(l,o),e(l,o)):t(o)}else t(o);o=a}}(f))}f=s,m=d}!function(e,t,n){for(;t;){var o=t.nextSibling;(n=S(t))?L(n):$(t,e,!0),t=o}}(t,m,i);var h=l[t.nodeName];h&&h(t,o)}(o,a):l.TEXTAREA(o,a)}(M,c,R),I)for(var W=0,D=I.length;W<D;W++){var J=V[I[W]];J&&$(J,J.parentNode,!1)}}return!R&&M!==i&&i.parentNode&&(M.actualize&&(M=M.actualize(i.ownerDocument||n)),i.parentNode.replaceChild(M,i)),M});let u="Sent Message:";console.log("Attempting to establish WebSocket connection");let f=new WebSocket(`${"https:"===window.location.protocol?"wss://":"ws://"}${window.location.host}/server?whence=${document.location.pathname}`);f.onmessage=e=>{console.log("Received message from server:",e.data),c(document.documentElement,e.data,{childrenOnly:!0})},f.onopen=()=>{console.log("WebSocket connection established.")},f.onerror=e=>{console.error("WebSocket error:",e)},f.onclose=e=>{e.wasClean?console.log(`WebSocket connection closed cleanly, code=${e.code}, reason=${e.reason}`):console.error("WebSocket connection closed unexpectedly, code=",e.code,"reason=",e.reason)};let m=e=>{let t=[...document.getElementById(e).elements],n=e=>[...e.children].map(e=>e.selected?e.value:"").filter(e=>e.length>0),o=e=>e.multiple?n(e):e.value;return t.reduce((e,t)=>{switch(t.tagName){case"SELECT":e[t.name]=o(t);break;case"TEXTAREA":e[t.name]=t.value}switch(t.type){case"text":e[t.name]=t.value;break;case"checkbox":e[t.name]=t.checked;break;case"radio":t.checked&&(e[t.name]=t.value)}return e},{})},v=e=>{history.pushState({},"",e);let t={message:"CHANGE_ROUTE",args:e};console.log(`${u}`,t),f.send(JSON.stringify(t))};window.gotea={sendMessage:(e,t)=>{let n={message:e,args:JSON.parse(t)};console.log(`${u}`,n),f.send(JSON.stringify(n))},submitForm:(e,t)=>{let n={message:e,args:m(t)};console.log(`${u}`,n),f.send(JSON.stringify(n))},sendMessageWithValue:(e,t)=>{let n={message:e,args:document.getElementById(t).value};console.log(`${u}`,n),f.send(JSON.stringify(n))}},window.addEventListener("popstate",e=>{let t={message:"CHANGE_ROUTE",args:document.location.pathname};console.log(`${u}`,t),f.send(JSON.stringify(t))}),document.addEventListener("click",e=>{if("A"===e.target.tagName&&!/external/.test(e.target.className))return e.preventDefault(),v(e.target.getAttribute("href")),!1},!1)})();
//# sourceMappingURL=main.js.map
